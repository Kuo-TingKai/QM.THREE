import{E as Ke,V as d,M as N,T as j,S as Me,Q as Te,a as y,R as Xe,P as Ue,b as Ve,c as Ze,d as qe,W as Qe,C as $e,e as Je,A as et,D as tt,L as nt,B as X,f as U,g as ee,h as te,i as ne}from"./three-DTRIzpL-.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function c(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(n){if(n.ep)return;n.ep=!0;const o=c(n);fetch(n.href,o)}})();const xe={type:"change"},oe={type:"start"},Le={type:"end"},V=new Xe,Oe=new Ue,ot=Math.cos(70*Ve.DEG2RAD);class it extends Ke{constructor(a,c){super(),this.object=a,this.domElement=c,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new d,this.cursor=new d,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:N.ROTATE,MIDDLE:N.DOLLY,RIGHT:N.PAN},this.touches={ONE:j.ROTATE,TWO:j.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",$),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(xe),e.update(),o=n.NONE},this.update=function(){const t=new d,i=new Te().setFromUnitVectors(a.up,new d(0,1,0)),u=i.clone().invert(),m=new d,b=new Te,C=new d,A=2*Math.PI;return function(Ge=null){const Pe=e.object.position;t.copy(Pe).sub(e.target),t.applyQuaternion(i),s.setFromVector3(t),e.autoRotate&&o===n.NONE&&k(Se(Ge)),e.enableDamping?(s.theta+=p.theta*e.dampingFactor,s.phi+=p.phi*e.dampingFactor):(s.theta+=p.theta,s.phi+=p.phi);let x=e.minAzimuthAngle,L=e.maxAzimuthAngle;isFinite(x)&&isFinite(L)&&(x<-Math.PI?x+=A:x>Math.PI&&(x-=A),L<-Math.PI?L+=A:L>Math.PI&&(L-=A),x<=L?s.theta=Math.max(x,Math.min(L,s.theta)):s.theta=s.theta>(x+L)/2?Math.max(x,s.theta):Math.min(L,s.theta)),s.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,s.phi)),s.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(f,e.dampingFactor):e.target.add(f),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor),e.zoomToCursor&&B||e.object.isOrthographicCamera?s.radius=q(s.radius):s.radius=q(s.radius*h),t.setFromSpherical(s),t.applyQuaternion(u),Pe.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(p.theta*=1-e.dampingFactor,p.phi*=1-e.dampingFactor,f.multiplyScalar(1-e.dampingFactor)):(p.set(0,0,0),f.set(0,0,0));let G=!1;if(e.zoomToCursor&&B){let Y=null;if(e.object.isPerspectiveCamera){const F=t.length();Y=q(F*h);const K=F-Y;e.object.position.addScaledVector(ie,K),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const F=new d(S.x,S.y,0);F.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/h)),e.object.updateProjectionMatrix(),G=!0;const K=new d(S.x,S.y,0);K.unproject(e.object),e.object.position.sub(K).add(F),e.object.updateMatrixWorld(),Y=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Y!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Y).add(e.object.position):(V.origin.copy(e.object.position),V.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(V.direction))<ot?a.lookAt(e.target):(Oe.setFromNormalAndCoplanarPoint(e.object.up,e.target),V.intersectPlane(Oe,e.target))))}else e.object.isOrthographicCamera&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/h)),e.object.updateProjectionMatrix(),G=!0);return h=1,B=!1,G||m.distanceToSquared(e.object.position)>l||8*(1-b.dot(e.object.quaternion))>l||C.distanceToSquared(e.target)>0?(e.dispatchEvent(xe),m.copy(e.object.position),b.copy(e.object.quaternion),C.copy(e.target),G=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",we),e.domElement.removeEventListener("pointerdown",ge),e.domElement.removeEventListener("pointercancel",z),e.domElement.removeEventListener("wheel",ye),e.domElement.removeEventListener("pointermove",Q),e.domElement.removeEventListener("pointerup",z),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",$),e._domElementKeyEvents=null)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=n.NONE;const l=1e-6,s=new Me,p=new Me;let h=1;const f=new d,g=new y,M=new y,O=new y,T=new y,w=new y,E=new y,P=new y,D=new y,R=new y,ie=new d,S=new y;let B=!1;const r=[],W={};function Se(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function _(){return Math.pow(.95,e.zoomSpeed)}function k(t){p.theta-=t}function H(t){p.phi-=t}const ae=function(){const t=new d;return function(u,m){t.setFromMatrixColumn(m,0),t.multiplyScalar(-u),f.add(t)}}(),se=function(){const t=new d;return function(u,m){e.screenSpacePanning===!0?t.setFromMatrixColumn(m,1):(t.setFromMatrixColumn(m,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(u),f.add(t)}}(),I=function(){const t=new d;return function(u,m){const b=e.domElement;if(e.object.isPerspectiveCamera){const C=e.object.position;t.copy(C).sub(e.target);let A=t.length();A*=Math.tan(e.object.fov/2*Math.PI/180),ae(2*u*A/b.clientHeight,e.object.matrix),se(2*m*A/b.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(ae(u*(e.object.right-e.object.left)/e.object.zoom/b.clientWidth,e.object.matrix),se(m*(e.object.top-e.object.bottom)/e.object.zoom/b.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function Z(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?h/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function re(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?h*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ce(t){if(!e.zoomToCursor)return;B=!0;const i=e.domElement.getBoundingClientRect(),u=t.clientX-i.left,m=t.clientY-i.top,b=i.width,C=i.height;S.x=u/b*2-1,S.y=-(m/C)*2+1,ie.set(S.x,S.y,1).unproject(e.object).sub(e.object.position).normalize()}function q(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function le(t){g.set(t.clientX,t.clientY)}function Ae(t){ce(t),P.set(t.clientX,t.clientY)}function de(t){T.set(t.clientX,t.clientY)}function De(t){M.set(t.clientX,t.clientY),O.subVectors(M,g).multiplyScalar(e.rotateSpeed);const i=e.domElement;k(2*Math.PI*O.x/i.clientHeight),H(2*Math.PI*O.y/i.clientHeight),g.copy(M),e.update()}function Ie(t){D.set(t.clientX,t.clientY),R.subVectors(D,P),R.y>0?Z(_()):R.y<0&&re(_()),P.copy(D),e.update()}function Ce(t){w.set(t.clientX,t.clientY),E.subVectors(w,T).multiplyScalar(e.panSpeed),I(E.x,E.y),T.copy(w),e.update()}function Ne(t){ce(t),t.deltaY<0?re(_()):t.deltaY>0&&Z(_()),e.update()}function je(t){let i=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?H(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,e.keyPanSpeed),i=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?H(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,-e.keyPanSpeed),i=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?k(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(e.keyPanSpeed,0),i=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?k(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(-e.keyPanSpeed,0),i=!0;break}i&&(t.preventDefault(),e.update())}function ue(){if(r.length===1)g.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),i=.5*(r[0].pageY+r[1].pageY);g.set(t,i)}}function me(){if(r.length===1)T.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),i=.5*(r[0].pageY+r[1].pageY);T.set(t,i)}}function pe(){const t=r[0].pageX-r[1].pageX,i=r[0].pageY-r[1].pageY,u=Math.sqrt(t*t+i*i);P.set(0,u)}function ve(){e.enableZoom&&pe(),e.enablePan&&me()}function Re(){e.enableZoom&&pe(),e.enableRotate&&ue()}function he(t){if(r.length==1)M.set(t.pageX,t.pageY);else{const u=J(t),m=.5*(t.pageX+u.x),b=.5*(t.pageY+u.y);M.set(m,b)}O.subVectors(M,g).multiplyScalar(e.rotateSpeed);const i=e.domElement;k(2*Math.PI*O.x/i.clientHeight),H(2*Math.PI*O.y/i.clientHeight),g.copy(M)}function fe(t){if(r.length===1)w.set(t.pageX,t.pageY);else{const i=J(t),u=.5*(t.pageX+i.x),m=.5*(t.pageY+i.y);w.set(u,m)}E.subVectors(w,T).multiplyScalar(e.panSpeed),I(E.x,E.y),T.copy(w)}function be(t){const i=J(t),u=t.pageX-i.x,m=t.pageY-i.y,b=Math.sqrt(u*u+m*m);D.set(0,b),R.set(0,Math.pow(D.y/P.y,e.zoomSpeed)),Z(R.y),P.copy(D)}function ke(t){e.enableZoom&&be(t),e.enablePan&&fe(t)}function ze(t){e.enableZoom&&be(t),e.enableRotate&&he(t)}function ge(t){e.enabled!==!1&&(r.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",Q),e.domElement.addEventListener("pointerup",z)),_e(t),t.pointerType==="touch"?Be(t):Ye(t))}function Q(t){e.enabled!==!1&&(t.pointerType==="touch"?We(t):Fe(t))}function z(t){He(t),r.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",Q),e.domElement.removeEventListener("pointerup",z)),e.dispatchEvent(Le),o=n.NONE}function Ye(t){let i;switch(t.button){case 0:i=e.mouseButtons.LEFT;break;case 1:i=e.mouseButtons.MIDDLE;break;case 2:i=e.mouseButtons.RIGHT;break;default:i=-1}switch(i){case N.DOLLY:if(e.enableZoom===!1)return;Ae(t),o=n.DOLLY;break;case N.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;de(t),o=n.PAN}else{if(e.enableRotate===!1)return;le(t),o=n.ROTATE}break;case N.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;le(t),o=n.ROTATE}else{if(e.enablePan===!1)return;de(t),o=n.PAN}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(oe)}function Fe(t){switch(o){case n.ROTATE:if(e.enableRotate===!1)return;De(t);break;case n.DOLLY:if(e.enableZoom===!1)return;Ie(t);break;case n.PAN:if(e.enablePan===!1)return;Ce(t);break}}function ye(t){e.enabled===!1||e.enableZoom===!1||o!==n.NONE||(t.preventDefault(),e.dispatchEvent(oe),Ne(t),e.dispatchEvent(Le))}function $(t){e.enabled===!1||e.enablePan===!1||je(t)}function Be(t){switch(Ee(t),r.length){case 1:switch(e.touches.ONE){case j.ROTATE:if(e.enableRotate===!1)return;ue(),o=n.TOUCH_ROTATE;break;case j.PAN:if(e.enablePan===!1)return;me(),o=n.TOUCH_PAN;break;default:o=n.NONE}break;case 2:switch(e.touches.TWO){case j.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ve(),o=n.TOUCH_DOLLY_PAN;break;case j.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Re(),o=n.TOUCH_DOLLY_ROTATE;break;default:o=n.NONE}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(oe)}function We(t){switch(Ee(t),o){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;he(t),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;fe(t),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ke(t),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ze(t),e.update();break;default:o=n.NONE}}function we(t){e.enabled!==!1&&t.preventDefault()}function _e(t){r.push(t)}function He(t){delete W[t.pointerId];for(let i=0;i<r.length;i++)if(r[i].pointerId==t.pointerId){r.splice(i,1);return}}function Ee(t){let i=W[t.pointerId];i===void 0&&(i=new y,W[t.pointerId]=i),i.set(t.pageX,t.pageY)}function J(t){const i=t.pointerId===r[0].pointerId?r[1]:r[0];return W[i.pointerId]}e.domElement.addEventListener("contextmenu",we),e.domElement.addEventListener("pointerdown",ge),e.domElement.addEventListener("pointercancel",z),e.domElement.addEventListener("wheel",ye,{passive:!1}),this.update()}}class at{constructor(){this.scene=new Ze,this.camera=new qe(75,window.innerWidth/window.innerHeight,.1,1e3);let a;try{const c=document.createElement("canvas"),e=c.getContext("webgl")||c.getContext("experimental-webgl")||c.getContext("webgl2");if(!e)throw new Error("WebGL not supported");const n=e.getParameter(e.MAX_TEXTURE_SIZE),o=e.getParameter(e.MAX_VIEWPORT_DIMS);console.log("WebGL capabilities:",{maxTextureSize:n,maxViewportDims:o,userAgent:navigator.userAgent}),a=new Qe({antialias:!0,alpha:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1})}catch(c){console.error("WebGL initialization failed:",c),this.showWebGLError();return}this.renderer=a,this.clock=new $e,this.controls=null,this.time=0,this.timeSpeed=1,this.isPaused=!1,this.quantumNumberX=3,this.quantumNumberY=4,this.displayMode="all",this.points=[],this.lines={real:null,imaginary:null,probability:null},this.init(),this.setupControls(),this.animate()}showWebGLError(){const a=document.createElement("div");a.style.cssText=`
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 1000;
            font-family: 'Orbitron', monospace;
        `,a.innerHTML=`
            <h3>WebGL Error</h3>
            <p>Your browser or environment doesn't support WebGL.</p>
            <p>Try using a different browser or device.</p>
        `,document.body.appendChild(a)}init(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(1118481),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Je,document.body.appendChild(this.renderer.domElement),this.controls=new it(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!1,this.controls.maxPolarAngle=Math.PI,this.setupCamera(),this.detectBrowserEnvironment(),this.setupScene(),this.createWaveFunction(),window.addEventListener("resize",()=>this.onWindowResize()),console.log("QuantumVisualizer initialized successfully")}setupCamera(){window.innerWidth<=768?(this.camera.position.set(3,3,4),this.camera.lookAt(0,0,0),this.controls.minDistance=2,this.controls.maxDistance=15):(this.camera.position.set(2,2,2),this.camera.lookAt(0,0,0),this.controls.minDistance=1,this.controls.maxDistance=10)}detectBrowserEnvironment(){const a=navigator.userAgent.toLowerCase(),c=a.includes("messenger")||a.includes("facebook")||a.includes("instagram")||a.includes("whatsapp")||a.includes("line")||a.includes("telegram");return c&&(console.log("Detected in-app browser, applying compatibility mode"),this.showInAppBrowserWarning()),c}showInAppBrowserWarning(){const a=document.createElement("div");a.style.cssText=`
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 165, 0, 0.95);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 1000;
            font-family: 'Orbitron', monospace;
            max-width: 300px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        `,a.innerHTML=`
            <h3>⚠️ 瀏覽器相容性</h3>
            <p>檢測到您正在使用應用內瀏覽器。</p>
            <p>建議使用系統瀏覽器以獲得最佳體驗。</p>
            <button onclick="this.parentElement.remove()" style="
                background: #0080ff;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                margin-top: 10px;
                cursor: pointer;
                font-family: 'Orbitron', monospace;
            ">知道了</button>
        `,document.body.appendChild(a)}setupScene(){const a=new et(4210752,.8);this.scene.add(a);const c=new tt(16777215,1);c.position.set(1,1,1),this.scene.add(c);const e=new nt({color:8947848,linewidth:3}),n=new X().setFromPoints([new d(-1,-1,0),new d(-1,1,0)]),o=new U(n,e);this.scene.add(o);const l=new X().setFromPoints([new d(1,-1,0),new d(1,1,0)]),s=new U(l,e);this.scene.add(s);const p=new X().setFromPoints([new d(-1,1,0),new d(1,1,0)]),h=new U(p,e);this.scene.add(h);const f=new X().setFromPoints([new d(-1,-1,0),new d(1,-1,0)]),g=new U(f,e);this.scene.add(g)}calculateWaveFunction(a,c,e,n,o){const l=e*.1,p=n*n+o*o,h=Math.cos(p*l),f=Math.sin(p*l),g=(a+1)/2,M=(c+1)/2,O=Math.sin(n*Math.PI*g),T=Math.sin(o*Math.PI*M),w=2*O*T,E=w*h,P=-w*f;return{real:E,imaginary:P,probability:E*E+P*P}}createWaveFunction(){this.lines.real&&this.scene.remove(this.lines.real),this.lines.imaginary&&this.scene.remove(this.lines.imaginary),this.lines.probability&&this.scene.remove(this.lines.probability);const a=50,c=.3,e=new ee(2,2,a-1,a-1),n=new te({color:16737894,transparent:!0,opacity:.7,wireframe:!0}),o=new ee(2,2,a-1,a-1),l=new te({color:6711039,transparent:!0,opacity:.7,wireframe:!0}),s=new ee(2,2,a-1,a-1),p=new te({color:6750054,transparent:!0,opacity:.8,wireframe:!1});this.updateSurfaceGeometry(e,"real",c,a),this.updateSurfaceGeometry(o,"imaginary",c,a),this.updateSurfaceGeometry(s,"probability",c,a),this.lines.real=new ne(e,n),this.lines.imaginary=new ne(o,l),this.lines.probability=new ne(s,p),this.lines.real.position.set(0,0,.1),this.lines.imaginary.position.set(0,0,-.1),this.lines.probability.position.set(0,0,0),this.updateDisplayMode()}updateSurfaceGeometry(a,c,e,n){const o=a.attributes.position.array;for(let l=0;l<o.length;l+=3){const s=o[l],p=o[l+1],h=this.calculateWaveFunction(s,p,this.time,this.quantumNumberX,this.quantumNumberY);let f=0;switch(c){case"real":f=h.real*e;break;case"imaginary":f=h.imaginary*e;break;case"probability":f=h.probability*e;break}o[l+2]=f}a.attributes.position.needsUpdate=!0,a.computeVertexNormals()}updateDisplayMode(){switch(this.scene.remove(this.lines.real),this.scene.remove(this.lines.imaginary),this.scene.remove(this.lines.probability),this.displayMode){case"all":this.scene.add(this.lines.real),this.scene.add(this.lines.imaginary),this.scene.add(this.lines.probability);break;case"real":this.scene.add(this.lines.real);break;case"imaginary":this.scene.add(this.lines.imaginary);break;case"probability":this.scene.add(this.lines.probability);break}}setupControls(){document.getElementById("quantumNumberX").addEventListener("change",s=>{this.quantumNumberX=parseInt(s.target.value),document.getElementById("currentNx").textContent=this.quantumNumberX,this.createWaveFunction()}),document.getElementById("quantumNumberY").addEventListener("change",s=>{this.quantumNumberY=parseInt(s.target.value),document.getElementById("currentNy").textContent=this.quantumNumberY,this.createWaveFunction()});const a=document.getElementById("timeSpeed"),c=document.getElementById("speedValue");a.addEventListener("input",s=>{this.timeSpeed=parseFloat(s.target.value),c.textContent=this.timeSpeed.toFixed(1)});const e=document.getElementById("pauseBtn"),n=document.querySelector(".status-indicator");e.addEventListener("click",()=>{this.isPaused=!this.isPaused,e.textContent=this.isPaused?"Resume":"Pause",this.isPaused?(n.className="status-indicator status-paused",n.parentElement.innerHTML='<span class="status-indicator status-paused"></span><strong>System Status:</strong> Paused'):(n.className="status-indicator status-active",n.parentElement.innerHTML='<span class="status-indicator status-active"></span><strong>System Status:</strong> Running')}),document.getElementById("resetBtn").addEventListener("click",()=>{this.time=0,this.createWaveFunction()}),document.getElementById("displayMode").addEventListener("change",s=>{this.displayMode=s.target.value,this.updateDisplayMode()});const o=document.getElementById("toggleUI"),l=document.querySelector(".ui-container");o&&l&&o.addEventListener("click",()=>{l.classList.toggle("hidden"),o.textContent=l.classList.contains("hidden")?"📱":"👁️"})}animate(){if(requestAnimationFrame(()=>this.animate()),!this.isPaused){const a=this.clock.getDelta();this.time+=a*this.timeSpeed,document.getElementById("time").textContent=this.time.toFixed(2),this.createWaveFunction()}this.controls&&this.controls.update(),this.renderer.render(this.scene,this.camera)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.setupCamera()}}window.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded, initializing QuantumVisualizer...");try{new at}catch(v){console.error("Failed to initialize QuantumVisualizer:",v);const a=document.createElement("div");a.style.cssText=`
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 1000;
            font-family: 'Orbitron', monospace;
        `,a.innerHTML=`
            <h3>Initialization Error</h3>
            <p>Failed to initialize the visualization.</p>
            <p>Error: ${v.message}</p>
        `,document.body.appendChild(a)}});
